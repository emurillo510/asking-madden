#!/usr/bin/python
import json
import requests
import time
import random

baseUrl="http://www.nfl.com"
userAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36"

# JSON string found from nfl-teans-list.html
json_teams = json.loads('{"BUF":{"abbr":"BUF","url":"http://www.buffalobills.com/?icampaign=nflcom-header-clublogos-BUF","teamPage":"/teams/buffalobills/profile?team=BUF","city":"Buffalo","nickname":"Bills","conference":"AFC","division":"East","shopId":"Buffalo_Bills_Gear/source/bm-nflcom-Header-Bills","facebook":"BuffaloBills","twitter":"BuffaloBills"},"MIA":{"abbr":"MIA","url":"http://www.miamidolphins.com/?icampaign=nflcom-header-clublogos-MIA","teamPage":"/teams/miamidolphins/profile?team=MIA","city":"Miami","nickname":"Dolphins","conference":"AFC","division":"East","shopId":"Miami_Dolphins_Gear/source/bm-nflcom-Header-Dolphins","facebook":"MiamiDolphins","twitter":"MiamiDolphins"},"NE":{"abbr":"NE","url":"http://www.patriots.com/?icampaign=nflcom-header-clublogos-NE","teamPage":"/teams/newenglandpatriots/profile?team=NE","city":"New England","nickname":"Patriots","conference":"AFC","division":"East","shopId":"New_England_Patriots_Gear/source/bm-nflcom-Header-Patriots","facebook":"newenglandpatriots","twitter":"PATRIOTS"},"NYJ":{"abbr":"NYJ","url":"http://www.newyorkjets.com/?icampaign=nflcom-header-clublogos-NYJ","teamPage":"/teams/newyorkjets/profile?team=NYJ","city":"New York","nickname":"Jets","conference":"AFC","division":"East","shopId":"New_York_Jets_Gear/source/bm-nflcom-Header-Jets","facebook":"Jets","twitter":"nyjets"},"BAL":{"abbr":"BAL","url":"http://www.baltimoreravens.com/?icampaign=nflcom-header-clublogos-BAL","teamPage":"/teams/baltimoreravens/profile?team=BAL","city":"Baltimore","nickname":"Ravens","conference":"AFC","division":"North","shopId":"Baltimore_Ravens_Gear/source/bm-nflcom-Header-Ravens","facebook":"baltimoreravens","twitter":"Ravens"},"CIN":{"abbr":"CIN","url":"http://www.bengals.com/?icampaign=nflcom-header-clublogos-CIN","teamPage":"/teams/cincinnatibengals/profile?team=CIN","city":"Cincinnati","nickname":"Bengals","conference":"AFC","division":"North","shopId":"Cincinnati_Bengals_Gear/source/bm-nflcom-Header-Bengals","facebook":"bengals","twitter":"Bengals"},"CLE":{"abbr":"CLE","url":"http://www.clevelandbrowns.com/?icampaign=nflcom-header-clublogos-CLE","teamPage":"/teams/clevelandbrowns/profile?team=CLE","city":"Cleveland","nickname":"Browns","conference":"AFC","division":"North","shopId":"Cleveland_Browns_Gear/source/bm-nflcom-Header-Browns","facebook":"clevelandbrowns","twitter":"OfficialBrowns"},"PIT":{"abbr":"PIT","url":"http://www.steelers.com/?icampaign=nflcom-header-clublogos-PIT","teamPage":"/teams/pittsburghsteelers/profile?team=PIT","city":"Pittsburgh","nickname":"Steelers","conference":"AFC","division":"North","shopId":"Pittsburgh_Steelers_Gear/source/bm-nflcom-Header-Steelers","facebook":"steelers","twitter":"steelers"},"HOU":{"abbr":"HOU","url":"http://www.houstontexans.com/?icampaign=nflcom-header-clublogos-HOU","teamPage":"/teams/houstontexans/profile?team=HOU","city":"Houston","nickname":"Texans","conference":"AFC","division":"South","shopId":"Houston_Texans_Gear/source/bm-nflcom-Header-Texans","facebook":"HoustonTexans","twitter":"HoustonTexans"},"IND":{"abbr":"IND","url":"http://www.colts.com/?icampaign=nflcom-header-clublogos-IND","teamPage":"/teams/indianapoliscolts/profile?team=IND","city":"Indianapolis","nickname":"Colts","conference":"AFC","division":"South","shopId":"Indianapolis_Colts_Gear/source/bm-nflcom-Header-Colts","facebook":"colts","twitter":"nflcolts"},"JAC":{"abbr":"JAC","url":"http://www.jaguars.com/?icampaign=nflcom-header-clublogos-JAX","teamPage":"/teams/jacksonvillejaguars/profile?team=JAC","city":"Jacksonville","nickname":"Jaguars","conference":"AFC","division":"South","shopId":"Jacksonville_Jaguars_Gear/source/bm-nflcom-Header-Jaguars","facebook":"jacksonvillejaguars","twitter":"jaguarsinsider"},"TEN":{"abbr":"TEN","url":"http://www.titansonline.com/?icampaign=nflcom-header-clublogos-TEN","teamPage":"/teams/tennesseetitans/profile?team=TEN","city":"Tennessee","nickname":"Titans","conference":"AFC","division":"South","shopId":"Tennessee_Titans_Gear/source/bm-nflcom-Header-Titans","facebook":"titans","twitter":"tennesseetitans"},"DEN":{"abbr":"DEN","url":"http://www.denverbroncos.com/?icampaign=nflcom-header-clublogos-DEN","teamPage":"/teams/denverbroncos/profile?team=DEN","city":"Denver","nickname":"Broncos","conference":"AFC","division":"West","shopId":"Denver_Broncos_Gear/source/bm-nflcom-Header-Broncos","facebook":"DenverBroncos","twitter":"Denver_Broncos"},"KC":{"abbr":"KC","url":"http://www.kcchiefs.com/?icampaign=nflcom-header-clublogos-KC","teamPage":"/teams/kansascitychiefs/profile?team=KC","city":"Kansas City","nickname":"Chiefs","conference":"AFC","division":"West","shopId":"Kansas_City_Chiefs_Gear/source/bm-nflcom-Header-Chiefs","facebook":"KansasCityChiefs","twitter":"kcchiefs"},"OAK":{"abbr":"OAK","url":"http://www.raiders.com/?icampaign=nflcom-header-clublogos-OAK","teamPage":"/teams/oaklandraiders/profile?team=OAK","city":"Oakland","nickname":"Raiders","conference":"AFC","division":"West","shopId":"Oakland_Raiders_Gear/source/bm-nflcom-Header-Raiders","facebook":"Raiders","twitter":"RAIDERS"},"SD":{"abbr":"SD","url":"http://www.chargers.com/?icampaign=nflcom-header-clublogos-SD","teamPage":"/teams/sandiegochargers/profile?team=SD","city":"San Diego","nickname":"Chargers","conference":"AFC","division":"West","shopId":"San_Diego_Chargers_Gear/source/bm-nflcom-Header-Chargers","facebook":"chargers","twitter":"chargers"},"DAL":{"abbr":"DAL","url":"http://www.dallascowboys.com/?icampaign=nflcom-header-clublogos-DAL","teamPage":"/teams/dallascowboys/profile?team=DAL","city":"Dallas","nickname":"Cowboys","conference":"NFC","division":"East","shopId":"Dallas_Cowboys_Gear/source/bm-nflcom-Header-Cowboys","facebook":"DallasCowboys","twitter":"dallascowboys"},"NYG":{"abbr":"NYG","url":"http://www.giants.com/?icampaign=nflcom-header-clublogos-NYG","teamPage":"/teams/newyorkgiants/profile?team=NYG","city":"New York","nickname":"Giants","conference":"NFL","division":"East","shopId":"New_York_Giants_Gear/source/bm-nflcom-Header-Giants","facebook":"newyorkgiants","twitter":"Giants"},"PHI":{"abbr":"PHI","url":"http://www.philadelphiaeagles.com/?icampaign=nflcom-header-clublogos-PHI","teamPage":"/teams/philadelphiaeagles/profile?team=PHI","city":"Philadelphia","nickname":"Eagles","conference":"NFC","division":"East","shopId":"Philadelphia_Eagles_Gear/source/bm-nflcom-Header-Eagles","facebook":"philadelphiaeagles","twitter":"Eagles"},"WAS":{"abbr":"WAS","url":"http://www.redskins.com/?icampaign=nflcom-header-clublogos-WAS","teamPage":"/teams/washingtonredskins/profile?team=WAS","city":"Washington","nickname":"Redskins","conference":"NFC","division":"East","shopId":"Washington_Redskins_Gear/source/bm-nflcom-Header-Redskins","facebook":"redskins","twitter":"Redskins"},"CHI":{"abbr":"CHI","url":"http://www.chicagobears.com/?icampaign=nflcom-header-clublogos-CHI","teamPage":"/teams/chicagobears/profile?team=CHI","city":"Chicago","nickname":"Bears","conference":"NFC","division":"North","shopId":"Chicago_Bears_Gear/source/bm-nflcom-Header-Bears","facebook":"ChicagoBears","twitter":"ChicagoBears"},"DET":{"abbr":"DET","url":"http://www.detroitlions.com/?icampaign=nflcom-header-clublogos-DET","teamPage":"/teams/detroitlions/profile?team=DET","city":"Detroit","nickname":"Lions","conference":"NFC","division":"North","shopId":"Detroit_Lions_Gear/source/bm-nflcom-Header-Lions","facebook":"DetroitLions","twitter":"DetroitLionsNFL"},"GB":{"abbr":"GB","url":"http://www.packers.com/?icampaign=nflcom-header-clublogos-GB","teamPage":"/teams/greenbaypackers/profile?team=GB","city":"Green Bay","nickname":"Packers","conference":"NFC","division":"North","shopId":"Green_Bay_Packers_Gear/source/bm-nflcom-Header-Packers","facebook":"Packers","twitter":"packers"},"MIN":{"abbr":"MIN","url":"http://www.vikings.com/?icampaign=nflcom-header-clublogos-MIN","teamPage":"/teams/minnesotavikings/profile?team=MIN","city":"Minnesota","nickname":"Vikings","conference":"NFC","division":"North","shopId":"Minnesota_Vikings_Gear/source/bm-nflcom-Header-Vikings","facebook":"minnesotavikings","twitter":"VikingsFootball"},"ATL":{"abbr":"ATL","url":"http://www.atlantafalcons.com/?icampaign=nflcom-header-clublogos-ATL","teamPage":"/teams/atlantafalcons/profile?team=ATL","city":"Atlanta","nickname":"Falcons","conference":"NFC","division":"South","shopId":"Atlanta_Falcons_Gear/source/bm-nflcom-Header-Falcons","facebook":"atlantafalcons","twitter":"Atlanta_Falcons"},"CAR":{"abbr":"CAR","url":"http://www.panthers.com/?icampaign=nflcom-header-clublogos-CAR","teamPage":"/teams/carolinapanthers/profile?team=CAR","city":"Carolina","nickname":"Panthers","conference":"NFC","division":"South","shopId":"Carolina_Panthers_Gear/source/bm-nflcom-Header-Panthers","facebook":"CarolinaPanthers","twitter":"Panthers"},"NO":{"abbr":"NO","url":"http://www.neworleanssaints.com/?icampaign=nflcom-header-clublogos-NO","teamPage":"/teams/neworleanssaints/profile?team=NO","city":"New Orleans","nickname":"Saints","conference":"NFC","division":"South","shopId":"New_Orleans_Saints_Gear/source/bm-nflcom-Header-Saints","facebook":"neworleanssaints","twitter":"Saints"},"TB":{"abbr":"TB","url":"http://www.buccaneers.com/?icampaign=nflcom-header-clublogos-TB","teamPage":"/teams/tampabaybuccaneers/profile?team=TB","city":"Tampa Bay","nickname":"Buccaneers","conference":"NFC","division":"South","shopId":"Tampa_Bay_Buccaneers_Gear/source/bm-nflcom-Header-Bucs","facebook":"tampabaybuccaneers","twitter":"TBBuccaneers"},"ARI":{"abbr":"ARI","url":"http://www.azcardinals.com/?icampaign=nflcom-header-clublogos-ARI","teamPage":"/teams/arizonacardinals/profile?team=ARI","city":"Arizona","nickname":"Cardinals","conference":"NFC","division":"West","shopId":"Arizona_Cardinals_Gear/source/bm-nflcom-Header-Cardinals","facebook":"arizonacardinals","twitter":"AZCardinals"},"STL":{"abbr":"STL","url":"http://www.stlouisrams.com/?icampaign=nflcom-header-clublogos-STL","teamPage":"/teams/st.louisrams/profile?team=STL","city":"St. Louis","nickname":"Rams","conference":"NFC","division":"West","shopId":"St_Louis_Rams/source/bm-nflcom-Header-Rams","facebook":"Rams","twitter":"STLouisRams"},"SF":{"abbr":"SF","url":"http://www.sf49ers.com/?icampaign=nflcom-header-clublogos-SF","teamPage":"/teams/sanfrancisco49ers/profile?team=SF","city":"San Francisco","nickname":"49ers","conference":"NFC","division":"West","shopId":"San_Francisco_49ers_Gear/source/bm-nflcom-Header-49ers","facebook":"SANFRANCISCO49ERS","twitter":"49ers"},"SEA":{"abbr":"SEA","url":"http://www.seahawks.com/?icampaign=nflcom-header-clublogos-SEA","teamPage":"/teams/seattleseahawks/profile?team=SEA","city":"Seattle","nickname":"Seahawks","conference":"NFC","division":"West","shopId":"Seattle_Seahawks_Gear/source/bm-nflcom-Header-Seahawks","facebook":"Seahawks","twitter":"Seahawks"}} ')


# get all team statistics page from json object
team_stats_links = []
for i in json_teams:
   page = json_teams[i]["teamPage"]
   page = page.replace("profile", "statistics")
   team_stats_links.append(str(baseUrl + page))

# get all team schedule page from json object
# get all team statistics page from json object
team_schedule_links = []
for i in json_teams:
   page = json_teams[i]["teamPage"]
   page = page.replace("profile", "schedule")
   team_schedule_links.append(str(baseUrl + page))


seasonType = ["REG","PRE"]
#http://www.nfl.com/teams/baltimoreravens/statistics?season=2002&team=BAL&seasonType=REG
# downloads all teams statistics page
counter=0
for i in range(2002,2016):
	for j in seasonType:
		for link in team_stats_links:
				page = link + "&" + "season=" + str(i) + "&" + "seasonType=" + j
				##cmd = "curl -v -L -A " + "'" + userAgent + "' " + page + " > 'target/nfl-teams-stats-" + str(i) + "-" + j + "-" +str(counter) +".html'" 
				##counter += 1
				#print page
				doc = requests.get(page)
				#print doc.text
				filename = "target/nfl-teams-stats-"+str(counter)+"-"+str(i)+"-"+j+".html"
				output = open(filename,'w')
				output.write(doc.text)
				output.close
				counter += 1
				time.sleep(random.randint(1,10)
				#sleep = "sleep $[ ( $RANDOM % 10 )  + 1 ]s"
				#subprocess.call(cmd, shell=True)
				
			

'''
seasonType = ["REG","PRE"]

#http://www.nfl.com/teams/baltimoreravens/statistics?season=2002&team=BAL&seasonType=REG
# downloads all teams statistics page
for i in range(2002,2016):
	for j in seasonType:
		for link in team_schedule_links:
			page = link + "&" + "season=" + str(i) + "&" + "seasonType=" + j
			print page
'''